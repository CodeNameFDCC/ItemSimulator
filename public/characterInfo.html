<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>캐릭터 정보 조회</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        margin: 20px;
        background-color: #f4f4f4;
      }
      h1 {
        text-align: center;
      }
      .container {
        max-width: 600px;
        margin: 0 auto;
        padding: 20px;
        background: white;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
      }
      .character-info {
        border: 1px solid #ccc;
        padding: 20px;
        border-radius: 8px;
      }
      .character-info img {
        max-width: 100%;
        border-radius: 8px;
      }
      .inventory,
      .equipped-items {
        margin-top: 20px;
      }
      .item {
        display: inline-block;
        border: 1px solid #ccc;
        padding: 10px;
        margin: 5px;
        text-align: center;
        border-radius: 5px;
        background-color: #fafafa;
      }
      .error {
        color: red;
        text-align: center;
      }
    </style>
  </head>
  <body>
    <div class="container">
      <h1>캐릭터 정보</h1>
      <div id="character-details" class="character-info" style="display: none">
        <h2 id="character-name"></h2>
        <img id="character-image" src="" alt="캐릭터 이미지" />
        <p id="character-description"></p>

        <h3>인벤토리</h3>
        <div id="inventory" class="inventory"></div>

        <h3>장착된 아이템</h3>
        <div id="equipped-items" class="equipped-items"></div>
      </div>

      <div id="error-message" class="error" style="display: none"></div>
    </div>

    <script>
      // 미리 정의된 캐릭터 ID

      // 페이지 로드 시 캐릭터 정보 가져오기
      window.onload = () => {
        const characterId = window.sessionStorage.getItem("characterId");
        fetchCharacterInfo(characterId);
      };

      // 선택한 캐릭터의 정보를 가져오는 함수
      async function fetchCharacterInfo(id) {
        alert(id);
        try {
          const response = await fetch(
            `http://localhost:3018/api/character/${id}`
          );
          if (!response.ok) {
            throw new Error("캐릭터를 찾을 수 없습니다.");
          }

          const character = await response.json();

          // 캐릭터 정보 표시
          document.getElementById("character-name").textContent =
            character.characterName;
          document.getElementById("character-image").src =
            character.characterImage || "default-image.png"; // 기본 이미지
          document.getElementById("character-description").textContent =
            character.description || "설명 없음";

          // // 인벤토리 표시
          // const inventoryDiv = document.getElementById("inventory");
          // inventoryDiv.innerHTML = "";
          // character.inventory.forEach((item) => {
          //   const itemDiv = document.createElement("div");
          //   itemDiv.className = "item";
          //   itemDiv.textContent = item.itemName; // 아이템 이름
          //   inventoryDiv.appendChild(itemDiv);
          // });

          // // 장착된 아이템 표시 (가정: equippedItems 필드가 존재한다고 가정)
          // const equippedDiv = document.getElementById("equipped-items");
          // equippedDiv.innerHTML = "";
          // if (character.equippedItems) {
          //   character.equippedItems.forEach((item) => {
          //     const equippedItemDiv = document.createElement("div");
          //     equippedItemDiv.className = "item";
          //     equippedItemDiv.textContent = item.itemName; // 장착된 아이템 이름
          //     equippedDiv.appendChild(equippedItemDiv);
          //   });
          // }

          // 캐릭터 정보 표시
          document.getElementById("character-details").style.display = "block";
          document.getElementById("error-message").style.display = "none";
        } catch (error) {
          document.getElementById("error-message").textContent = error.message;
          document.getElementById("error-message").style.display = "block";
          document.getElementById("character-details").style.display = "none";
        }
      }
    </script>
  </body>
</html>
