<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>비 오는 로그인 및 회원가입</title>
    <style>
      body {
        margin: 0;
        height: 100vh;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: #2c3e50;
        color: white;
        font-family: Arial, sans-serif;
        overflow: hidden;
        position: relative;
      }

      .container {
        background: rgba(44, 62, 80, 0.8);
        padding: 20px;
        border-radius: 8px;
        box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
        text-align: center;
        width: 300px;
        position: relative; /* Position relative to stack with rain */
        z-index: 10; /* Bring the container above the rain */
      }

      input {
        display: block;
        width: 100%;
        padding: 10px;
        margin: 10px 0;
        border: none;
        border-radius: 5px;
      }

      button {
        padding: 10px;
        border: none;
        border-radius: 5px;
        background-color: #3498db;
        color: white;
        cursor: pointer;
      }

      button:hover {
        background-color: #2980b9;
      }

      .rain {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        pointer-events: none;
        overflow: hidden;
        z-index: 1; /* Set rain behind the containers */
      }

      .drop {
        position: absolute;
        background: rgba(255, 255, 255, 0.8);
        width: 2px;
        height: 10px;
        animation: fall linear infinite;
      }

      @keyframes fall {
        0% {
          transform: translateY(-100%);
        }
        100% {
          transform: translateY(100vh);
        }
      }

      /* 숨기기 및 보이기 스타일 */
      .hidden {
        display: none;
      }
    </style>
  </head>
  <body>
    <div class="rain"></div>
    <div id="login-container" class="container">
      <h1>로그인</h1>
      <input type="text" id="username" placeholder="사용자 이름" />
      <input type="password" id="password" placeholder="비밀번호" />
      <button id="login-button">로그인</button>
      <p id="login-message"></p>
      <p>계정이 없으신가요? <a href="#" id="show-register">회원가입</a></p>
    </div>

    <div id="register-container" class="container hidden">
      <h1>회원가입</h1>
      <input type="email" id="email" placeholder="이메일" />
      <input type="text" id="new-username" placeholder="사용자 이름" />
      <input type="password" id="new-password" placeholder="비밀번호" />
      <button id="register-button">회원가입</button>
      <p id="register-message"></p>
      <p>이미 계정이 있으신가요? <a href="#" id="show-login">로그인</a></p>
    </div>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const rainContainer = document.querySelector(".rain");

        // 비 드롭 생성
        const createRainDrop = () => {
          const drop = document.createElement("div");
          drop.classList.add("drop");
          drop.style.left = Math.random() * 100 + "vw";
          drop.style.animationDuration = Math.random() * 0.5 + 0.5 + "s"; // 0.5초에서 1초 사이
          rainContainer.appendChild(drop);

          // 드롭이 떨어진 후 제거
          drop.addEventListener("animationend", () => {
            drop.remove();
          });
        };

        // 일정 간격으로 드롭 생성
        setInterval(createRainDrop, 100);

        // 로그인과 회원가입 전환
        document
          .getElementById("show-register")
          .addEventListener("click", (e) => {
            e.preventDefault();
            document.getElementById("login-container").classList.add("hidden");
            document
              .getElementById("register-container")
              .classList.remove("hidden");
          });

        document.getElementById("show-login").addEventListener("click", (e) => {
          e.preventDefault();
          document.getElementById("register-container").classList.add("hidden");
          document.getElementById("login-container").classList.remove("hidden");
        });

        // 로그인 버튼 클릭 시 처리
        document
          .getElementById("login-button")
          .addEventListener("click", () => {
            // 로그인 로직 구현
            const username = document.getElementById("username").value;
            const password = document.getElementById("password").value;

            // 여기서 실제 로그인 요청을 처리하는 로직을 추가하세요.
            document.getElementById("login-message").innerText = "로그인 성공!"; // 예시 메시지
          });

        // 회원가입 버튼 클릭 시 처리
        document
          .getElementById("register-button")
          .addEventListener("click", () => {
            // 회원가입 로직 구현
            const newUsername = document.getElementById("new-username").value;
            const newPassword = document.getElementById("new-password").value;
            const email = document.getElementById("email").value;
            fetch("http://wjdxo.shop:3018/api/register", {
              method: "POST",
              headers: {
                "Content-Type": "application/json",
              },
              body: JSON.stringify({
                email: email,
                loginId: newUsername,
                password: newPassword,
              }),
            })
              .then((response) => response.json())
              .then((data) => {
                if (data.success) {
                  document.getElementById("register-message").innerText =
                    "회원가입 성공!";
                } else {
                  document.getElementById("register-message").innerText =
                    "회원가입 실패: " + data.message;
                }
              })
              .catch((error) => {
                document.getElementById("register-message").innerText =
                  "오류 발생: " + error.message;
              });
            document.getElementById("register-message").innerText =
              "회원가입 성공!"; // 예시 메시지
          });
      });
    </script>
  </body>
</html>
